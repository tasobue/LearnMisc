Private Sub CommandButton1_Click()
    Dim targetDate As Date
    Dim targetDate2 As Date
    Dim preparation As Integer
    Dim i As Long
    Dim newday As Date
    Dim strDate() As Variant
    
    
    '変換できる値かを調べる
    If IsDate(Worksheets("Sheet1").TextBox1.Value) = False Then
      
      MsgBox "有効な日付を入力してください"
      Exit Sub
    
    End If

    
    '1.テキスト１の値を取得
    targetDate = Worksheets("Sheet1").TextBox1.Value
    
    '今月の月末日
    targetDate2 = DateSerial(Year(Date), _
    Month(Date) + 1, 0)
    
    '１ヵ月分取得したいから、”2021/01”が付くものをすべて取得できる？
     'targetDate2 = DateAdd("d", 1, targetDate)
     
    'テキストの差分をとる
    preparation = DateDiff("d", targetDate, targetDate2)
    
    '配列を再定義
    ReDim strDate(preparation)
    
    i = 0
    
    For i = 0 To preparation
    
  
    
    strDate(i) = DateAdd("d", i, targetDate)
    
    
    Next
    
      
    
    'output()を呼び出して出力する
    Call output(strDate)
    'Call test(strDate())
End Sub
